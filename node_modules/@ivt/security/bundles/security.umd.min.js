!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@angular/core"),require("@ivt/http-client"),require("rxjs/add/operator/map"),require("@angular/common/http"),require("rxjs/Observable"),require("rxjs/operators"),require("@angular/common")):"function"==typeof define&&define.amd?define(["exports","@angular/core","@ivt/http-client","rxjs/add/operator/map","@angular/common/http","rxjs/Observable","rxjs/operators","@angular/common"],e):e(t.ivtSecurity={},t.ng.core,t.ivtHttpClient,t.Rx.Observable.prototype,t.ng.common,t.Rx,t.catchError,t.ng.common)}(this,function(t,e,r,o,n,i,s,u){"use strict";var c,a=function(){function t(){this.apiUrl="",this.rememberLogin=!1}return t.prototype.onUnAuthorized=function(t){},t.decorators=[{type:e.Injectable}],t}(),p=function(){function t(){}return t.prototype.save=function(t,e){null!==e&&"object"==typeof e&&(localStorage.setItem(t+"_type","object"),e=JSON.stringify(e)),localStorage.setItem(t,e)},t.prototype.get=function(t){var e=localStorage.getItem(t)||sessionStorage.getItem(t);return"object"===(localStorage.getItem(t+"_type")||sessionStorage.getItem(t+"_type"))?JSON.parse(e):"null"===e?null:e},t.prototype.remove=function(t){localStorage.removeItem(t),localStorage.removeItem(t+"_type")},t.decorators=[{type:e.Injectable}],t}(),l=function(){function t(t,e,r){this.http=t,this.db=e,this.config=r,this.loadUserCredentials()}return t.prototype.loadUserCredentials=function(){this.useCredentials(this.db.get("user"))},t.prototype.useCredentials=function(t){t&&(this.user=t)},t.prototype.destroyUserCredentials=function(){this.db.remove("user"),this.user=null},t.prototype.storeUserCredentials=function(t){!0===this.config.rememberLogin&&this.db.save("user",t),this.useCredentials(t)},t.prototype.afterLogin=function(t){t.code===r.APICode.Success&&this.storeUserCredentials(t.data)},t.prototype.login=function(t){var e=this;return this.http.post(this.config.apiUrl,t,{params:{auth:"false"}}).map(function(t){var r=t;return e.afterLogin(r),r})},t.prototype.logout=function(){this.destroyUserCredentials()},t.prototype.getUser=function(){return this.user},t.prototype.isAuthenticated=function(){return this.user&&this.user.token},t}(),f=(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])},function(t,e){function r(){this.constructor=t}c(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),d=function(t){function r(e,r,o){var n=t.call(this,e,r,o)||this;return n.http=e,n.db=r,n.config=o,n}return f(r,t),r.decorators=[{type:e.Injectable}],r.ctorParameters=function(){return[{type:n.HttpClient},{type:p},{type:a}]},r}(l),y=function(){function t(t){this.config=t}return t.prototype.intercept=function(t,e){var r=this;return e.handle(t).pipe(s.catchError(function(t){return t instanceof n.HttpErrorResponse&&401===t.status&&r.config.onUnAuthorized(t),i.Observable.throw(t)}))},t.decorators=[{type:e.Injectable}],t.ctorParameters=function(){return[{type:a}]},t}(),h=function(){return function(){}}(),g=function(){return function(){}}(),m=function(){function t(){}return t.forRoot=function(){return{ngModule:t,providers:[a,d,p,{provide:n.HTTP_INTERCEPTORS,useClass:y,multi:!0}]}},t.decorators=[{type:e.NgModule,args:[{imports:[u.CommonModule,r.IvtHttpClientModule],exports:[],declarations:[]}]}],t}();t.IvtSecurityConfig=a,t.IvtSecurityService=d,t.IvtStorageService=p,t.Tenant=h,t.User=g,t.IvtSecurityAbstractService=l,t.IvtSecurityInterceptor=y,t.IvtSecurityModule=m,Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=security.umd.min.js.map
